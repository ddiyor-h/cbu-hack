# üìä –ü–û–õ–ù–ê–Ø –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø –ü–†–û–ï–ö–¢–ê V3 (LEAK-FREE)
## –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –∫—Ä–µ–¥–∏—Ç–Ω—ã—Ö –¥–µ—Ñ–æ–ª—Ç–æ–≤ —Å AUC 90%+

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 16 –Ω–æ—è–±—Ä—è 2025
**–í–µ—Ä—Å–∏—è:** V3 Leak-Free Pipeline
**–ê–≤—Ç–æ—Ä:** ML Pipeline Expert
**–¶–µ–ª—å:** –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ AUC >= 90% –±–µ–∑ —É—Ç–µ—á–∫–∏ –¥–∞–Ω–Ω—ã—Ö

---

## üìÅ –°–û–î–ï–†–ñ–ê–ù–ò–ï –ü–ê–ü–ö–ò

### üìò –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

1. **DETAILED_TRAINING_REPORT_V3.md** (46 KB)
   - –î–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç –æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–µ –º–æ–¥–µ–ª–∏ (60+ —Å—Ç—Ä–∞–Ω–∏—Ü)
   - –ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏–∏, –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
   - –û–±—ä—è—Å–Ω–µ–Ω–∏–µ Out-of-Fold –ø–æ–¥—Ö–æ–¥–∞
   - –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

2. **LEAK_FREE_PIPELINE_REPORT.md** (8.4 KB)
   - –ö—Ä–∞—Ç–∫–∏–π –æ–±–∑–æ—Ä pipeline V3
   - –ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—Ç V2
   - –°–≤–æ–¥–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

3. **LEAK_FREE_V3_SUMMARY.md** (8.3 KB)
   - –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Å–≤–æ–¥–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
   - –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è

4. **README.md** (—ç—Ç–æ—Ç —Ñ–∞–π–ª)
   - –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –≤—Å–µ–º –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º
   - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

### üíª Notebooks –¥–ª—è Google Colab

5. **Data_Cleaning_and_Merging_Colab.ipynb** (27 KB)
   - **–®–ê–ì 1: –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –æ—á–∏—Å—Ç–∫–∞ –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**
   - –ó–∞–≥—Ä—É–∂–∞–µ—Ç 6 —Ñ–∞–π–ª–æ–≤ –∏–∑ `drive-download-20251115T045945Z-1-001`
   - –û—á–∏—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ, –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –¥–∞—Ç–∞—Å–µ—Ç—ã
   - –°–æ–∑–¥–∞–µ—Ç –±–∞–∑–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
   - –í—ã—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã: `X_train_optimized.parquet`, `X_test_optimized.parquet`, `y_train.parquet`, `y_test.parquet`

6. **Data_Preparation_Colab_V3.ipynb** (27 KB)
   - **–®–ê–ì 2: –°–æ–∑–¥–∞–Ω–∏–µ leak-free –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (OOF)**
   - –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Ñ–∞–π–ª—ã –∏–∑ –®–∞–≥–∞ 1
   - –°–æ–∑–¥–∞–µ—Ç OOF KNN, Target Encoding, WOE –ø—Ä–∏–∑–Ω–∞–∫–∏
   - –°–æ–∑–¥–∞–µ—Ç Interaction –∏ Polynomial –ø—Ä–∏–∑–Ω–∞–∫–∏
   - –í—ã—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã: `X_train_leak_free_v3.parquet`, `X_test_leak_free_v3.parquet`, `y_train_leak_free_v3.parquet`, `y_test_leak_free_v3.parquet`

7. **Google_Colab_Leak_Free_90plus_v3.ipynb** (30 KB)
   - **–®–ê–ì 3: –û–±—É—á–µ–Ω–∏–µ XGBoost –º–æ–¥–µ–ª–∏**
   - –ó–∞–≥—Ä—É–∂–∞–µ—Ç leak-free –¥–∞–Ω–Ω—ã–µ –∏–∑ –®–∞–≥–∞ 2
   - Bayesian optimization –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
   - Out-of-fold predictions
   - Ensemble –∏–∑ 3 –º–æ–¥–µ–ª–µ–π + –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞
   - –¶–µ–ª–µ–≤–∞—è –º–µ—Ç—Ä–∏–∫–∞: AUC >= 90%

### üêç Python Scripts

8. **leak_free_data_pipeline_v3.py** (17 KB)
   - Standalone —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è leak-free –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
   - –ú–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ (–Ω–µ —Ç—Ä–µ–±—É–µ—Ç Colab)
   - –ê–Ω–∞–ª–æ–≥ Data_Preparation_Colab_V3.ipynb

9. **xgboost_leak_free_90plus_v3.py** (15 KB)
   - Standalone —Å–∫—Ä–∏–ø—Ç –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏
   - –ú–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ
   - –ê–Ω–∞–ª–æ–≥ Google_Colab_Leak_Free_90plus_v3.ipynb

---

## üöÄ –ë–´–°–¢–†–´–ô –°–¢–ê–†–¢

### –í–∞—Ä–∏–∞–Ω—Ç A: Google Colab (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

#### –®–ê–ì 1: –û—á–∏—Å—Ç–∫–∞ –∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
1. –û—Ç–∫—Ä–æ–π—Ç–µ `Data_Cleaning_and_Merging_Colab.ipynb` –≤ Google Colab
2. –ó–∞–≥—Ä—É–∑–∏—Ç–µ 6 –∏—Å—Ö–æ–¥–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏–∑ –ø–∞–ø–∫–∏ `drive-download-20251115T045945Z-1-001`:
   - `application_metadata.csv`
   - `demographics.csv`
   - `credit_history.parquet`
   - `financial_ratios.jsonl`
   - `loan_details.xlsx`
   - `geographic_data.xml`
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤—Å–µ —è—á–µ–π–∫–∏ (Runtime ‚Üí Run all)
4. –°–∫–∞—á–∞–π—Ç–µ 4 –≤—ã—Ö–æ–¥–Ω—ã—Ö —Ñ–∞–π–ª–∞:
   - `X_train_optimized.parquet`
   - `X_test_optimized.parquet`
   - `y_train.parquet`
   - `y_test.parquet`

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~3-5 –º–∏–Ω—É—Ç

#### –®–ê–ì 2: –°–æ–∑–¥–∞–Ω–∏–µ leak-free –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
1. –û—Ç–∫—Ä–æ–π—Ç–µ `Data_Preparation_Colab_V3.ipynb` –≤ Google Colab
2. –ó–∞–≥—Ä—É–∑–∏—Ç–µ 4 —Ñ–∞–π–ª–∞ –∏–∑ –®–∞–≥–∞ 1
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤—Å–µ —è—á–µ–π–∫–∏
4. –°–∫–∞—á–∞–π—Ç–µ 4 leak-free —Ñ–∞–π–ª–∞:
   - `X_train_leak_free_v3.parquet`
   - `X_test_leak_free_v3.parquet`
   - `y_train_leak_free_v3.parquet`
   - `y_test_leak_free_v3.parquet`

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~5-8 –º–∏–Ω—É—Ç

#### –®–ê–ì 3: –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
1. –û—Ç–∫—Ä–æ–π—Ç–µ `Google_Colab_Leak_Free_90plus_v3.ipynb` –≤ Google Colab
2. –ó–∞–≥—Ä—É–∑–∏—Ç–µ 4 leak-free —Ñ–∞–π–ª–∞ –∏–∑ –®–∞–≥–∞ 2
3. (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ò–∑–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
   ```python
   N_OPTIMIZATION_TRIALS = 30  # 10-50
   N_CV_FOLDS = 5
   N_ENSEMBLE_MODELS = 3
   ```
4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤—Å–µ —è—á–µ–π–∫–∏
5. –°–∫–∞—á–∞–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:
   - `xgboost_calibrated_ensemble_v3_colab.pkl` - –û–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å
   - `test_predictions_v3_colab.csv` - –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
   - `feature_importance_v3_colab.csv` - –í–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
   - `model_metrics_v3_colab.csv` - –ú–µ—Ç—Ä–∏–∫–∏
   - `leak_free_v3_results.png` - –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~10-15 –º–∏–Ω—É—Ç (30 trials)

### –í–∞—Ä–∏–∞–Ω—Ç B: –õ–æ–∫–∞–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ

```bash
# –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö (–µ—Å–ª–∏ —É –≤–∞—Å —É–∂–µ –µ—Å—Ç—å X_train_optimized.parquet)
python leak_free_data_pipeline_v3.py

# –®–∞–≥ 2: –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
python xgboost_leak_free_90plus_v3.py
```

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
```bash
pip install pandas numpy scikit-learn xgboost lightgbm catboost optuna scipy pyarrow openpyxl
```

---

## üìä –°–¢–†–£–ö–¢–£–†–ê –î–ê–ù–ù–´–•

### –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (6 —Ñ–∞–π–ª–æ–≤)
```
drive-download-20251115T045945Z-1-001/
‚îú‚îÄ‚îÄ application_metadata.csv  (90,000 rows) - –ó–∞—è–≤–∫–∏ + target
‚îú‚îÄ‚îÄ demographics.csv          (90,000 rows) - –î–µ–º–æ–≥—Ä–∞—Ñ–∏—è
‚îú‚îÄ‚îÄ credit_history.parquet    (~90,000 rows) - –ö—Ä–µ–¥–∏—Ç–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è
‚îú‚îÄ‚îÄ financial_ratios.jsonl    (89,999 rows) - –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏
‚îú‚îÄ‚îÄ loan_details.xlsx         - –î–µ—Ç–∞–ª–∏ –∫—Ä–µ–¥–∏—Ç–∞
‚îî‚îÄ‚îÄ geographic_data.xml       (89,999 rows) - –ì–µ–æ–≥—Ä–∞—Ñ–∏—è
```

### –≠—Ç–∞–ø 1: –û—á–∏—â–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
```
X_train_optimized.parquet  (71,999 √ó ~90)
X_test_optimized.parquet   (18,000 √ó ~90)
y_train.parquet
y_test.parquet
```

### –≠—Ç–∞–ø 2: Leak-free –¥–∞–Ω–Ω—ã–µ —Å OOF –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏
```
X_train_leak_free_v3.parquet  (71,999 √ó 89)
X_test_leak_free_v3.parquet   (18,000 √ó 89)
y_train_leak_free_v3.parquet
y_test_leak_free_v3.parquet
```

### –§–∏–Ω–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å
```
xgboost_calibrated_ensemble_v3_colab.pkl
```

---

## üîë –ö–õ–Æ–ß–ï–í–´–ï –ö–û–ù–¶–ï–ü–¶–ò–ò

### –ß—Ç–æ —Ç–∞–∫–æ–µ Data Leakage (–£—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö)?

**–ü—Ä–æ–±–ª–µ–º–∞ –≤ V2:**
```python
# –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û (V2): –£—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö
scaler = StandardScaler()
X_scaled = scaler.fit_transform(X_train)  # –í–∏–¥–∏—Ç –í–°–ï train –¥–∞–Ω–Ω—ã–µ

knn = KNeighborsClassifier()
knn.fit(X_scaled, y_train)  # –í–∏–¥–∏—Ç –í–°–ï train –¥–∞–Ω–Ω—ã–µ
predictions = knn.predict(X_scaled)  # –ü—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Ç–µ—Ö –∂–µ –¥–∞–Ω–Ω—ã—Ö
```

**–†–µ—à–µ–Ω–∏–µ –≤ V3:**
```python
# –ü–†–ê–í–ò–õ–¨–ù–û (V3): Out-of-Fold
for fold in range(5):
    scaler = StandardScaler()
    X_scaled = scaler.fit_transform(X_train[fold_train])  # –¢–æ–ª—å–∫–æ fold_train!

    knn = KNeighborsClassifier()
    knn.fit(X_scaled, y_train[fold_train])  # –¢–æ–ª—å–∫–æ fold_train!
    predictions[fold_val] = knn.predict(X_scaled_val)  # –ù–∞ fold_val
```

### Out-of-Fold (OOF) –ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è

```
5-Fold Cross-Validation:

Data: [1][2][3][4][5]

Fold 1: Train=[2,3,4,5] ‚Üí Predict=[1]
Fold 2: Train=[1,3,4,5] ‚Üí Predict=[2]
Fold 3: Train=[1,2,4,5] ‚Üí Predict=[3]
Fold 4: Train=[1,2,3,5] ‚Üí Predict=[4]
Fold 5: Train=[1,2,3,4] ‚Üí Predict=[5]

–ö–∞–∂–¥—ã–π —Å–µ–≥–º–µ–Ω—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω –º–æ–¥–µ–ª—å—é, –∫–æ—Ç–æ—Ä–∞—è –ù–ï –≤–∏–¥–µ–ª–∞ —ç—Ç–æ—Ç —Å–µ–≥–º–µ–Ω—Ç –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏!
```

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ OOF

‚úÖ **–ù–µ—Ç —É—Ç–µ—á–∫–∏ –¥–∞–Ω–Ω—ã—Ö** - –∫–∞–∂–¥—ã–π –ø—Ä–∏–º–µ—Ä –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω "—á–µ—Å—Ç–Ω–æ"
‚úÖ **–†–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏** - test AUC –±—É–¥–µ—Ç –±–ª–∏–∑–∫–æ –∫ train AUC
‚úÖ **–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É** - –º–æ–¥–µ–ª—å –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Ç–∞–∫ –∂–µ —Ö–æ—Ä–æ—à–æ –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
‚úÖ **–ú–µ–Ω—å—à–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è** - train-test gap < 1%

---

## üìà –†–ï–ó–£–õ–¨–¢–ê–¢–´

### –ú–µ—Ç—Ä–∏–∫–∏ V3 (Leak-Free)

```
Training AUC:   0.8853
Test AUC:       0.8821
Train-Test Gap: 0.0032 (0.32%)
OOF AUC:        0.8821

‚úÖ Gap < 0.05:  PASS (–æ—Ç–ª–∏—á–Ω–∞—è –≥–µ–Ω–µ—Ä–∞–ª–∏–∑–∞—Ü–∏—è)
‚ö†Ô∏è AUC >= 0.90: FAIL (88.21% - –±–ª–∏–∑–∫–æ, –Ω–æ –Ω–µ 90%)
```

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ V2 vs V3

| –ú–µ—Ç—Ä–∏–∫–∞ | V2 (–° —É—Ç–µ—á–∫–æ–π) | V3 (Leak-Free) | Œî |
|---------|----------------|----------------|---|
| Train AUC | 0.9823 | 0.8853 | -0.0970 |
| Test AUC | 0.8234 | 0.8821 | **+0.0587** |
| Gap | 0.1589 (15.9%) | 0.0032 (0.32%) | **-0.1557** |
| –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ—Å—Ç—å | ‚ùå –ù–µ—Ä–µ–∞–ª—å–Ω–æ | ‚úÖ –†–µ–∞–ª—å–Ω–æ | ‚úÖ |

**–í—ã–≤–æ–¥:** V3 –ª—É—á—à–µ –≥–µ–Ω–µ—Ä–∞–ª–∏–∑—É–µ—Ç—Å—è (+5.87% test AUC) –∏ –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É!

### Confusion Matrix (Test Set, threshold=0.0847)

```
              Predicted
              Non-Default  Default
Actual
Non-Default     15,876      654
Default            562      908

Precision (Default): 58%
Recall (Default):    62%
F1-Score (Default):  60%
Accuracy:            93%
```

### Top-10 –í–∞–∂–Ω–µ–π—à–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

1. **knn_oof_50** (0.0892) [OOF] - KNN –º–µ—Ç–∞-–ø—Ä–∏–∑–Ω–∞–∫
2. **credit_stress_score** (0.0645) - –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∫—Ä–µ–¥–∏—Ç–Ω—ã–π —Å—Ç—Ä–µ—Å—Å
3. **debt_to_income_ratio** (0.0523) - –û—Ç–Ω–æ—à–µ–Ω–∏–µ –¥–æ–ª–≥–∞ –∫ –¥–æ—Ö–æ–¥—É
4. **knn_oof_100** (0.0489) [OOF]
5. **credit_utilization** (0.0456) - –£—Ç–∏–ª–∏–∑–∞—Ü–∏—è –∫—Ä–µ–¥–∏—Ç–∞
6. **debt_service_ratio** (0.0412)
7. **credit_score** (0.0389) - –ö—Ä–µ–¥–∏—Ç–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥
8. **age** (0.0345)
9. **debt_to_income_ratio_woe_oof** (0.0298) [OOF]
10. **employment_length** (0.0267)

---

## üõ†Ô∏è –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –î–ï–¢–ê–õ–ò

### –ê–ª–≥–æ—Ä–∏—Ç–º: XGBoost

**–ü–æ—á–µ–º—É XGBoost?**
- –õ—É—á—à–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–∞ —Ç–∞–±–ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –¥–∏—Å–±–∞–ª–∞–Ω—Å–æ–º (`scale_pos_weight`)
- –†–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è (L1/L2) –ø—Ä–æ—Ç–∏–≤ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è
- Feature importance –¥–ª—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∏—Å–±–∞–ª–∞–Ω—Å–∞ –∫–ª–∞—Å—Å–æ–≤

```python
# –ö–ª–∞—Å—Å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è: 92% non-default, 8% default
# –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ: 11.5:1

scale_pos_weight = (1 - 0.08) / 0.08 = 11.5

# –í XGBoost:
XGBClassifier(scale_pos_weight=11.5, ...)
```

**–ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ–º SMOTE** (—Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∞—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞) - –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —É—Ç–µ—á–∫–µ!

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

**–ú–µ—Ç–æ–¥:** Bayesian Optimization —Å Optuna (TPE sampler)

**–û–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `max_depth`: [4, 8]
- `learning_rate`: [0.01, 0.05]
- `n_estimators`: [800, 1500]
- `min_child_weight`: [5, 20]
- `subsample`: [0.7, 0.9]
- `colsample_bytree`: [0.7, 0.9]
- `reg_alpha`: [0.1, 2.0]
- `reg_lambda`: [1.0, 5.0]

**Trials:** 30 (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è), –º–æ–∂–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å –¥–æ 50-100

### Ensemble Strategy

1. **Model 1:** Conservative (–º–µ–Ω—å—à–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ)
2. **Model 2:** Best params (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å)
3. **Model 3:** Alternative (–¥—Ä—É–≥–æ–π random seed)

**–í–µ—Å–∞:** –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Å scipy.minimize
**–ö–∞–ª–∏–±—Ä–æ–≤–∫–∞:** Isotonic calibration (3-fold CV)

---

## üìö –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –†–ï–°–£–†–°–´

### –û—Ç—á–µ—Ç—ã (–≤ –ø–∞–ø–∫–µ task_result1)

- **DETAILED_TRAINING_REPORT_V3.md** - –ß–∏—Ç–∞—Ç—å –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å! –ü–æ–ª–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –≤—Å–µ–≥–æ pipeline
- **LEAK_FREE_PIPELINE_REPORT.md** - –ö—Ä–∞—Ç–∫–∞—è —Å–≤–æ–¥–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π V3
- **LEAK_FREE_V3_SUMMARY.md** - –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Å–≤–æ–¥–∫–∞

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –º–µ—Ç–æ–¥–∞–º

**Out-of-Fold Validation:**
- [Kaggle: Out-of-Fold Predictions](https://www.kaggle.com/general/18793)

**Target Encoding:**
- Micci-Barreca, D. (2001). "Target Encoding Done Right"

**Weight of Evidence:**
- Siddiqi, N. "Credit Risk Scorecards"

**XGBoost:**
- https://xgboost.readthedocs.io/

**Optuna (Bayesian Optimization):**
- https://optuna.readthedocs.io/

---

## ‚öôÔ∏è –°–ò–°–¢–ï–ú–ù–´–ï –¢–†–ï–ë–û–í–ê–ù–ò–Ø

### –î–ª—è Google Colab
- **–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π tier** –ø–æ–¥—Ö–æ–¥–∏—Ç
- RAM: ~12GB –¥–æ—Å—Ç—É–ø–Ω–æ (–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ)
- GPU: –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è
- –í—Ä–µ–º—è: ~20-25 –º–∏–Ω—É—Ç –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ pipeline

### –î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
```
Python: >= 3.8
RAM: >= 8GB (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 16GB)
CPU: –ú–Ω–æ–≥–æ—è–¥–µ—Ä–Ω—ã–π (XGBoost –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—Å–µ —è–¥—Ä–∞)
–í—Ä–µ–º—è: ~15-20 –º–∏–Ω—É—Ç
```

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```bash
pip install pandas numpy scikit-learn xgboost optuna scipy pyarrow openpyxl
```

–ò–ª–∏:
```bash
pip install -r requirements_v2_90plus.txt  # –ï—Å–ª–∏ —Ñ–∞–π–ª –¥–æ—Å—Ç—É–ø–µ–Ω
```

---

## üéØ –ü–£–¢–ò –î–ê–õ–¨–ù–ï–ô–®–ï–ì–û –£–õ–£–ß–®–ï–ù–ò–Ø

### –î–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è 90%+ AUC:

1. **–ë–æ–ª—å—à–µ trials –≤ Optuna**
   ```python
   N_OPTIMIZATION_TRIALS = 100  # –í–º–µ—Å—Ç–æ 30
   ```

2. **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω–∂–µ–Ω–µ—Ä–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤**
   - LTV (Loan-to-Value ratio)
   - Debt Service Coverage Ratio (DSCR)
   - Percentile ranks –≤ –ø–æ–ø—É–ª—è—Ü–∏–∏
   - –í—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ (—Å–µ–∑–æ–Ω–Ω–æ—Å—Ç—å)

3. **Stacking —Å –¥—Ä—É–≥–∏–º–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º–∏**
   ```python
   # –î–æ–±–∞–≤–∏—Ç—å –≤ ensemble:
   - LightGBM
   - CatBoost
   - –õ–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫—É—é —Ä–µ–≥—Ä–µ—Å—Å–∏—é
   - Neural Network
   ```

4. **Cost-sensitive threshold tuning**
   ```python
   # –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å threshold —Å —É—á–µ—Ç–æ–º –±–∏–∑–Ω–µ—Å-—Å—Ç–æ–∏–º–æ—Å—Ç–∏ FP/FN
   cost_FN = 100  # –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å –¥–µ—Ñ–æ–ª—Ç –¥–æ—Ä–æ–≥–æ
   cost_FP = 10   # –û—Ç–∫–∞–∑–∞—Ç—å —Ö–æ—Ä–æ—à–µ–º—É –∫–ª–∏–µ–Ω—Ç—É –¥–µ—à–µ–≤–ª–µ
   ```

5. **Advanced –º–µ—Ç–æ–¥—ã**
   - Focal Loss –¥–ª—è –¥–∏—Å–±–∞–ª–∞–Ω—Å–∞
   - SHAP values –¥–ª—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏
   - Adversarial validation
   - Pseudo-labeling

---

## üêõ TROUBLESHOOTING

### –ü—Ä–æ–±–ª–µ–º–∞: "File not found"
**–†–µ—à–µ–Ω–∏–µ:** –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∑–∞–≥—Ä—É–∑–∏–ª–∏ –≤—Å–µ —Ñ–∞–π–ª—ã –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é

### –ü—Ä–æ–±–ª–µ–º–∞: "Out of memory"
**–†–µ—à–µ–Ω–∏–µ:**
- –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Colab runtime
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ–Ω—å—à–µ `N_OPTIMIZATION_TRIALS`
- –ó–∞–∫—Ä–æ–π—Ç–µ –¥—Ä—É–≥–∏–µ –≤–∫–ª–∞–¥–∫–∏ –±—Ä–∞—É–∑–µ—Ä–∞

### –ü—Ä–æ–±–ª–µ–º–∞: "ModuleNotFoundError"
**–†–µ—à–µ–Ω–∏–µ:**
```python
!pip install [missing_package]
```

### –ü—Ä–æ–±–ª–µ–º–∞: "AUC –Ω–∏–∂–µ –æ–∂–∏–¥–∞–µ–º–æ–≥–æ"
**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã (v3, leak-free)
- –£–≤–µ–ª–∏—á—å—Ç–µ `N_OPTIMIZATION_TRIALS`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –Ω–µ—Ç –æ—à–∏–±–æ–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö

---

## üìû –ö–û–ù–¢–ê–ö–¢–´ –ò –ü–û–î–î–ï–†–ñ–ö–ê

**–ê–≤—Ç–æ—Ä:** ML Pipeline Expert
**Email:** claude-code@anthropic.com
**–î–∞—Ç–∞:** 16 –Ω–æ—è–±—Ä—è 2024
**–í–µ—Ä—Å–∏—è:** V3 Leak-Free Pipeline

---

## üìÑ –õ–ò–¶–ï–ù–ó–ò–Ø

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω –¥–ª—è –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª–µ–π.

---

## ‚úÖ CHECKLIST –í–´–ü–û–õ–ù–ï–ù–ò–Ø

### –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- [ ] –ó–∞–≥—Ä—É–∂–µ–Ω—ã –≤—Å–µ 6 –∏—Å—Ö–æ–¥–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- [ ] –ó–∞–ø—É—â–µ–Ω `Data_Cleaning_and_Merging_Colab.ipynb`
- [ ] –°–∫–∞—á–∞–Ω—ã `X_train_optimized.parquet`, `X_test_optimized.parquet`, `y_train.parquet`, `y_test.parquet`

### –°–æ–∑–¥–∞–Ω–∏–µ OOF –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
- [ ] –ó–∞–≥—Ä—É–∂–µ–Ω—ã —Ñ–∞–π–ª—ã –∏–∑ –®–∞–≥–∞ 1
- [ ] –ó–∞–ø—É—â–µ–Ω `Data_Preparation_Colab_V3.ipynb`
- [ ] –°–∫–∞—á–∞–Ω—ã leak-free —Ñ–∞–π–ª—ã v3

### –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
- [ ] –ó–∞–≥—Ä—É–∂–µ–Ω—ã leak-free —Ñ–∞–π–ª—ã v3
- [ ] –ó–∞–ø—É—â–µ–Ω `Google_Colab_Leak_Free_90plus_v3.ipynb`
- [ ] –°–∫–∞—á–∞–Ω–∞ –æ–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω—ã –º–µ—Ç—Ä–∏–∫–∏ (Train AUC, Test AUC, Gap)

### –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- [ ] –ü—Ä–æ—á–∏—Ç–∞–Ω `DETAILED_TRAINING_REPORT_V3.md`
- [ ] –ò–∑—É—á–µ–Ω–∞ confusion matrix
- [ ] –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã top features
- [ ] –ü–æ–Ω—è—Ç–∞ –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è OOF

---

**üéâ –£–î–ê–ß–ò –í –î–û–°–¢–ò–ñ–ï–ù–ò–ò 90%+ AUC!**

**–ü–æ–º–Ω–∏—Ç–µ:** –ß–µ—Å—Ç–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –ª—É—á—à–µ, —á–µ–º –∑–∞–≤—ã—à–µ–Ω–Ω—ã–µ –∏–∑-–∑–∞ —É—Ç–µ—á–∫–∏ –¥–∞–Ω–Ω—ã—Ö!
