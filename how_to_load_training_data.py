"""
–ö–∞–∫ –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç –¥–ª—è –æ–±—É—á–µ–Ω–∏—è ML –º–æ–¥–µ–ª–∏

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
"""

import pandas as pd

print("="*80)
print("–ó–ê–ì–†–£–ó–ö–ê –§–ò–ù–ê–õ–¨–ù–û–ì–û –î–ê–¢–ê–°–ï–¢–ê –î–õ–Ø –û–ë–£–ß–ï–ù–ò–Ø")
print("="*80)

# ============================================================================
# –í–ê–†–ò–ê–ù–¢ 1: –î–ª—è –¥—Ä–µ–≤–æ–≤–∏–¥–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π (XGBoost, LightGBM, Random Forest)
# ============================================================================

print("\n1Ô∏è‚É£  –î–õ–Ø –î–†–ï–í–û–í–ò–î–ù–´–• –ú–û–î–ï–õ–ï–ô (XGBoost, LightGBM, CatBoost, Random Forest):")
print("-" * 80)

# –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–µ–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
X_train = pd.read_parquet('/home/dr/cbu/X_train.parquet')
X_test = pd.read_parquet('/home/dr/cbu/X_test.parquet')
y_train = pd.read_parquet('/home/dr/cbu/y_train.parquet')
y_test = pd.read_parquet('/home/dr/cbu/y_test.parquet')

print(f"‚úÖ X_train: {X_train.shape}")
print(f"‚úÖ X_test:  {X_test.shape}")
print(f"‚úÖ y_train: {y_train.shape}")
print(f"‚úÖ y_test:  {y_test.shape}")

# –¶–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è - –æ–¥–Ω–æ–º–µ—Ä–Ω—ã–π –º–∞—Å—Å–∏–≤
y_train = y_train['default'].values
y_test = y_test['default'].values

print(f"\nüìä –ë–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤ –≤ y_train:")
print(f"   - –ö–ª–∞—Å—Å 0 (–Ω–µ—Ç –¥–µ—Ñ–æ–ª—Ç–∞): {(y_train == 0).sum():,} ({(y_train == 0).sum() / len(y_train) * 100:.2f}%)")
print(f"   - –ö–ª–∞—Å—Å 1 (–¥–µ—Ñ–æ–ª—Ç):      {(y_train == 1).sum():,} ({(y_train == 1).sum() / len(y_train) * 100:.2f}%)")

# –ü—Ä–∏–º–µ—Ä –æ–±—É—á–µ–Ω–∏—è XGBoost
print("\nüí° –ü—Ä–∏–º–µ—Ä –æ–±—É—á–µ–Ω–∏—è XGBoost:")
print("-" * 80)
print("""
from xgboost import XGBClassifier

model = XGBClassifier(
    objective='binary:logistic',
    eval_metric='auc',
    scale_pos_weight=18.6,  # –í–∞–∂–Ω–æ –¥–ª—è –¥–∏—Å–±–∞–ª–∞–Ω—Å–∞!
    random_state=42
)

model.fit(X_train, y_train)
predictions = model.predict_proba(X_test)[:, 1]
""")

# ============================================================================
# –í–ê–†–ò–ê–ù–¢ 2: –î–ª—è –ª–∏–Ω–µ–π–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π (Logistic Regression)
# ============================================================================

print("\n2Ô∏è‚É£  –î–õ–Ø –õ–ò–ù–ï–ô–ù–´–• –ú–û–î–ï–õ–ï–ô (Logistic Regression, Ridge, Lasso):")
print("-" * 80)

# –ó–∞–≥—Ä—É–∂–∞–µ–º –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
X_train_scaled = pd.read_parquet('/home/dr/cbu/X_train_scaled.parquet')
X_test_scaled = pd.read_parquet('/home/dr/cbu/X_test_scaled.parquet')
y_train_lr = pd.read_parquet('/home/dr/cbu/y_train.parquet')['default'].values
y_test_lr = pd.read_parquet('/home/dr/cbu/y_test.parquet')['default'].values

print(f"‚úÖ X_train_scaled: {X_train_scaled.shape}")
print(f"‚úÖ X_test_scaled:  {X_test_scaled.shape}")

print("\nüí° –ü—Ä–∏–º–µ—Ä –æ–±—É—á–µ–Ω–∏—è Logistic Regression:")
print("-" * 80)
print("""
from sklearn.linear_model import LogisticRegression

model = LogisticRegression(
    class_weight='balanced',  # –í–∞–∂–Ω–æ –¥–ª—è –¥–∏—Å–±–∞–ª–∞–Ω—Å–∞!
    max_iter=1000,
    random_state=42
)

model.fit(X_train_scaled, y_train_lr)
predictions = model.predict_proba(X_test_scaled)[:, 1]
""")

# ============================================================================
# –í–ê–†–ò–ê–ù–¢ 3: –ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–∏)
# ============================================================================

print("\n3Ô∏è‚É£  –ò–°–•–û–î–ù–´–ï –î–ê–ù–ù–´–ï (–¥–æ feature engineering):")
print("-" * 80)

df_imputed = pd.read_parquet('/home/dr/cbu/final_dataset_imputed.parquet')

print(f"‚úÖ final_dataset_imputed.parquet: {df_imputed.shape}")
print(f"   - 62 –∏—Å—Ö–æ–¥–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏ (–±–µ–∑ –∏–Ω–∂–µ–Ω–µ—Ä–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤)")
print(f"   - –í—Å–µ –ø—Ä–æ–ø—É—Å–∫–∏ –∏–º–ø—É—Ç–∏—Ä–æ–≤–∞–Ω—ã")
print(f"   - –ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ù–ï –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω—ã (–∏—Å—Ö–æ–¥–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è)")

print("\nüí° –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ:")
print("   ‚Ä¢ –°–æ–∑–¥–∞—Ç—å —Å–≤–æ–∏ –∏–Ω–∂–µ–Ω–µ—Ä–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏")
print("   ‚Ä¢ –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –¥—Ä—É–≥–∏–µ –º–µ—Ç–æ–¥—ã –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è")
print("   ‚Ä¢ –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Å —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è–º–∏")

# ============================================================================
# –ü–û–õ–ï–ó–ù–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø
# ============================================================================

print("\n" + "="*80)
print("üìö –ü–û–õ–ï–ó–ù–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø")
print("="*80)

print("\nüóÇÔ∏è  –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤:")
print("""
final_dataset_clean.csv       ‚Üí –ò—Å—Ö–æ–¥–Ω—ã–µ –æ—á–∏—â–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (62 –∫–æ–ª–æ–Ω–∫–∏)
final_dataset_imputed.parquet ‚Üí –ò–º–ø—É—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (62 –∫–æ–ª–æ–Ω–∫–∏)
X_train.parquet              ‚Üí –û–±—É—á–∞—é—â–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ (108 –∫–æ–ª–æ–Ω–æ–∫, –Ω–µ–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ)
X_test.parquet               ‚Üí –¢–µ—Å—Ç–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ (108 –∫–æ–ª–æ–Ω–æ–∫, –Ω–µ–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ)
X_train_scaled.parquet       ‚Üí –û–±—É—á–∞—é—â–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ (108 –∫–æ–ª–æ–Ω–æ–∫, –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ)
X_test_scaled.parquet        ‚Üí –¢–µ—Å—Ç–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ (108 –∫–æ–ª–æ–Ω–æ–∫, –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ)
y_train.parquet              ‚Üí –¶–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–±—É—á–µ–Ω–∏–µ (72,000)
y_test.parquet               ‚Üí –¶–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è —Ç–µ—Å—Ç (17,999)
""")

print("üìä –ß—Ç–æ —Å–æ–¥–µ—Ä–∂–∞—Ç 108 –∫–æ–ª–æ–Ω–æ–∫:")
print("""
‚Ä¢ 47 –∏—Å—Ö–æ–¥–Ω—ã—Ö —á–∏—Å–ª–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
‚Ä¢ 12 –∏–Ω–∂–µ–Ω–µ—Ä–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (—Å–æ–∑–¥–∞–Ω–Ω—ã–µ)
‚Ä¢ 42 One-Hot –ø—Ä–∏–∑–Ω–∞–∫–∞ (–∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö)
‚Ä¢ 7 Frequency-encoded –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
""")

print("‚ö†Ô∏è  –ß—Ç–æ –ù–£–ñ–ù–û —É–¥–∞–ª–∏—Ç—å –ø–µ—Ä–µ–¥ –æ–±—É—á–µ–Ω–∏–µ–º:")
print("""
‚Ä¢ customer_ref (ID)
‚Ä¢ application_id (ID)
‚Ä¢ loan_officer_id (ID)
‚Ä¢ previous_zip_code (—Å–ª—É–∂–µ–±–Ω–∞—è)

–ü–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è: 108 - 4 = 104 –ø—Ä–∏–∑–Ω–∞–∫–∞ –¥–ª—è –º–æ–¥–µ–ª–∏
""")

print("\n‚úÖ –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏ –≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!")
print("="*80)
